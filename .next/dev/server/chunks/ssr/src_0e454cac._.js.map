{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/etelliott10/Desktop/lotly/lotlyAdmin/src/lib/api.ts"],"sourcesContent":["export const apiBaseUrl =\n  process.env.NEXT_PUBLIC_API_BASE ?? \"http://localhost:8000\";\n\nexport async function apiGet<TResponse>(path: string): Promise<TResponse> {\n  const response = await fetch(`${apiBaseUrl}${path}`, {\n    method: \"GET\",\n    credentials: \"include\",\n  });\n\n  const text = await response.text();\n  const data = text ? (JSON.parse(text) as TResponse & { detail?: string }) : null;\n\n  if (!response.ok) {\n    const message =\n      (data && \"detail\" in data && data.detail) ||\n      `Request failed (${response.status})`;\n    throw new Error(message);\n  }\n\n  return data as TResponse;\n}\n\nexport async function apiPost<TResponse>(\n  path: string,\n  payload: Record<string, unknown>,\n): Promise<TResponse> {\n  const response = await fetch(`${apiBaseUrl}${path}`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    credentials: \"include\",\n    body: JSON.stringify(payload),\n  });\n\n  const text = await response.text();\n  const data = text ? (JSON.parse(text) as TResponse & { detail?: string }) : null;\n\n  if (!response.ok) {\n    const message =\n      (data && \"detail\" in data && data.detail) ||\n      `Request failed (${response.status})`;\n    throw new Error(message);\n  }\n\n  return data as TResponse;\n}\n"],"names":[],"mappings":";;;;;;;;AAAO,MAAM,aACX,6DAAoC;AAE/B,eAAe,OAAkB,IAAY;IAClD,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,MAAM,EAAE;QACnD,QAAQ;QACR,aAAa;IACf;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,MAAM,OAAO,OAAQ,KAAK,KAAK,CAAC,QAA4C;IAE5E,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,UACJ,AAAC,QAAQ,YAAY,QAAQ,KAAK,MAAM,IACxC,CAAC,gBAAgB,EAAE,SAAS,MAAM,CAAC,CAAC,CAAC;QACvC,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;AAEO,eAAe,QACpB,IAAY,EACZ,OAAgC;IAEhC,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,MAAM,EAAE;QACnD,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QACA,aAAa;QACb,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,MAAM,OAAO,OAAQ,KAAK,KAAK,CAAC,QAA4C;IAE5E,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,UACJ,AAAC,QAAQ,YAAY,QAAQ,KAAK,MAAM,IACxC,CAAC,gBAAgB,EAAE,SAAS,MAAM,CAAC,CAAC,CAAC;QACvC,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/login/page.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"card\": \"page-module__aydn6q__card\",\n  \"error\": \"page-module__aydn6q__error\",\n  \"form\": \"page-module__aydn6q__form\",\n  \"header\": \"page-module__aydn6q__header\",\n  \"input\": \"page-module__aydn6q__input\",\n  \"kicker\": \"page-module__aydn6q__kicker\",\n  \"label\": \"page-module__aydn6q__label\",\n  \"metaLabel\": \"page-module__aydn6q__metaLabel\",\n  \"metaRow\": \"page-module__aydn6q__metaRow\",\n  \"metaValue\": \"page-module__aydn6q__metaValue\",\n  \"mfaHint\": \"page-module__aydn6q__mfaHint\",\n  \"page\": \"page-module__aydn6q__page\",\n  \"primaryButton\": \"page-module__aydn6q__primaryButton\",\n  \"secondaryButton\": \"page-module__aydn6q__secondaryButton\",\n  \"subtitle\": \"page-module__aydn6q__subtitle\",\n  \"success\": \"page-module__aydn6q__success\",\n  \"token\": \"page-module__aydn6q__token\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["file:///Users/etelliott10/Desktop/lotly/lotlyAdmin/src/app/login/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { apiPost, apiBaseUrl } from \"@/lib/api\";\nimport styles from \"./page.module.css\";\n\ntype LoginResponse = {\n  mfa_required: boolean;\n  access_token?: string;\n  token_type?: string;\n  user_id?: number;\n  portal?: string;\n  profile_id?: number;\n  challenge_id?: number;\n  method?: string;\n};\n\ntype MfaVerifyResponse = {\n  access_token: string;\n  token_type: string;\n};\n\ntype LoginStep = \"login\" | \"mfa\" | \"success\";\n\nexport default function AdminLoginPage() {\n  const router = useRouter();\n  const [step, setStep] = useState<LoginStep>(\"login\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [deviceName, setDeviceName] = useState(\"Lotly Admin Console\");\n  const [mfaCode, setMfaCode] = useState(\"\");\n  const [challengeId, setChallengeId] = useState<number | null>(null);\n  const [accessToken, setAccessToken] = useState(\"\");\n  const [error, setError] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const maskedEmail = useMemo(() => {\n    if (!email.includes(\"@\")) return email;\n    const [user, domain] = email.split(\"@\");\n    return `${user.slice(0, 2)}***@${domain}`;\n  }, [email]);\n\n  const handleLogin = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    setError(null);\n    setIsLoading(true);\n\n    try {\n      const response = await apiPost<LoginResponse>(\"/lotly-admin/auth/login\", {\n        email,\n        password,\n        device_name: deviceName || null,\n      });\n\n      if (response.mfa_required) {\n        setChallengeId(response.challenge_id ?? null);\n        setStep(\"mfa\");\n        setIsLoading(false);\n        return;\n      }\n\n      if (response.access_token) {\n        setAccessToken(response.access_token);\n        sessionStorage.setItem(\"lotly_admin_access_token\", response.access_token);\n        setStep(\"success\");\n        router.push(\"/\");\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Login failed.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleMfaVerify = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    setError(null);\n    setIsLoading(true);\n\n    try {\n      if (!challengeId) {\n        throw new Error(\"Missing MFA challenge ID.\");\n      }\n      const response = await apiPost<MfaVerifyResponse>(\n        \"/lotly-admin/auth/mfa/verify\",\n        {\n          challenge_id: challengeId,\n          code: mfaCode,\n        },\n      );\n      setAccessToken(response.access_token);\n      sessionStorage.setItem(\"lotly_admin_access_token\", response.access_token);\n      setStep(\"success\");\n      router.push(\"/\");\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"MFA verification failed.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className={styles.page}>\n      <main className={styles.card}>\n        <header className={styles.header}>\n          <p className={styles.kicker}>Lotly Admin</p>\n          <h1>Secure admin access</h1>\n          <p className={styles.subtitle}>\n            Sign in to manage tenants, platform operations, and compliance across\n            the Lotly network.\n          </p>\n        </header>\n\n        <div className={styles.metaRow}>\n          <div>\n            <p className={styles.metaLabel}>API</p>\n            <p className={styles.metaValue}>{apiBaseUrl}</p>\n          </div>\n          <div>\n            <p className={styles.metaLabel}>Security</p>\n            <p className={styles.metaValue}>MFA-ready sessions</p>\n          </div>\n        </div>\n\n        {step === \"login\" && (\n          <form className={styles.form} onSubmit={handleLogin}>\n            <label className={styles.label}>\n              Email\n              <input\n                className={styles.input}\n                type=\"email\"\n                name=\"email\"\n                placeholder=\"admin@lotly.com\"\n                value={email}\n                onChange={(event) => setEmail(event.target.value)}\n                required\n              />\n            </label>\n            <label className={styles.label}>\n              Password\n              <input\n                className={styles.input}\n                type=\"password\"\n                name=\"password\"\n                placeholder=\"••••••••\"\n                value={password}\n                onChange={(event) => setPassword(event.target.value)}\n                required\n              />\n            </label>\n            <label className={styles.label}>\n              Device name\n              <input\n                className={styles.input}\n                type=\"text\"\n                name=\"device\"\n                placeholder=\"Admin workstation\"\n                value={deviceName}\n                onChange={(event) => setDeviceName(event.target.value)}\n              />\n            </label>\n            {error && <p className={styles.error}>{error}</p>}\n            <button className={styles.primaryButton} type=\"submit\" disabled={isLoading}>\n              {isLoading ? \"Signing in...\" : \"Sign in\"}\n            </button>\n          </form>\n        )}\n\n        {step === \"mfa\" && (\n          <form className={styles.form} onSubmit={handleMfaVerify}>\n            <p className={styles.mfaHint}>\n              Enter the 6-digit code for {maskedEmail || \"your account\"}.\n            </p>\n            <label className={styles.label}>\n              MFA code\n              <input\n                className={styles.input}\n                type=\"text\"\n                name=\"mfa\"\n                inputMode=\"numeric\"\n                autoComplete=\"one-time-code\"\n                placeholder=\"123456\"\n                value={mfaCode}\n                onChange={(event) => setMfaCode(event.target.value)}\n                required\n              />\n            </label>\n            {error && <p className={styles.error}>{error}</p>}\n            <button className={styles.primaryButton} type=\"submit\" disabled={isLoading}>\n              {isLoading ? \"Verifying...\" : \"Verify\"}\n            </button>\n            <button\n              className={styles.secondaryButton}\n              type=\"button\"\n              onClick={() => {\n                setStep(\"login\");\n                setMfaCode(\"\");\n                setError(null);\n              }}\n            >\n              Back to login\n            </button>\n          </form>\n        )}\n\n        {step === \"success\" && (\n          <div className={styles.success}>\n            <h2>Login confirmed</h2>\n            <p>Access token issued for admin API calls.</p>\n            <div className={styles.token}>{accessToken || \"Token unavailable\"}</div>\n            <Link className={styles.primaryButton} href=\"/\">\n              Go to dashboard\n            </Link>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}