(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9165,e=>{"use strict";let a="http://localhost:8000";function t(e){(401===e||403===e)&&(sessionStorage.removeItem("lotly_admin_access_token"),sessionStorage.removeItem("lotly_access_token"),window.location.pathname.startsWith("/login")||(window.location.href="/login"))}async function l(e){let l=await fetch(`${a}${e}`,{method:"GET",credentials:"include"});l.ok||t(l.status);let s=await l.text(),n=s?JSON.parse(s):null;if(!l.ok)throw Error(n&&"detail"in n&&n.detail||`Request failed (${l.status})`);return n}async function s(e,l){let s=await fetch(`${a}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)});s.ok||t(s.status);let n=await s.text(),i=n?JSON.parse(n):null;if(!s.ok)throw Error(i&&"detail"in i&&i.detail||`Request failed (${s.status})`);return i}async function n(e,l){let s=await fetch(`${a}${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)});s.ok||t(s.status);let n=await s.text(),i=n?JSON.parse(n):null;if(!s.ok)throw Error(i&&"detail"in i&&i.detail||`Request failed (${s.status})`);return i}e.s(["apiBaseUrl",0,a,"apiGet",()=>l,"apiPatch",()=>n,"apiPost",()=>s])},28616,e=>{e.v({card:"page-module__aydn6q__card",error:"page-module__aydn6q__error",form:"page-module__aydn6q__form",header:"page-module__aydn6q__header",input:"page-module__aydn6q__input",kicker:"page-module__aydn6q__kicker",label:"page-module__aydn6q__label",metaLabel:"page-module__aydn6q__metaLabel",metaRow:"page-module__aydn6q__metaRow",metaValue:"page-module__aydn6q__metaValue",mfaHint:"page-module__aydn6q__mfaHint",page:"page-module__aydn6q__page",primaryButton:"page-module__aydn6q__primaryButton",secondaryButton:"page-module__aydn6q__secondaryButton",subtitle:"page-module__aydn6q__subtitle",success:"page-module__aydn6q__success",token:"page-module__aydn6q__token"})},94542,e=>{"use strict";var a=e.i(43476),t=e.i(71645),l=e.i(22016),s=e.i(18566),n=e.i(9165),i=e.i(28616);function o(){let e=(0,s.useRouter)(),[o,d]=(0,t.useState)("login"),[r,c]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[p,_]=(0,t.useState)("Lotly Admin Console"),[f,h]=(0,t.useState)(""),[y,g]=(0,t.useState)(null),[x,j]=(0,t.useState)(""),[b,N]=(0,t.useState)(null),[k,v]=(0,t.useState)(!1),S=(0,t.useMemo)(()=>{if(!r.includes("@"))return r;let[e,a]=r.split("@");return`${e.slice(0,2)}***@${a}`},[r]),q=async a=>{a.preventDefault(),N(null),v(!0);try{let a=await (0,n.apiPost)("/lotly-admin/auth/login",{email:r,password:u,device_name:p||null});if(a.mfa_required){g(a.challenge_id??null),d("mfa"),v(!1);return}a.access_token&&(j(a.access_token),sessionStorage.setItem("lotly_admin_access_token",a.access_token),d("success"),e.push("/"))}catch(e){N(e instanceof Error?e.message:"Login failed.")}finally{v(!1)}},w=async a=>{a.preventDefault(),N(null),v(!0);try{if(!y)throw Error("Missing MFA challenge ID.");let a=await (0,n.apiPost)("/lotly-admin/auth/mfa/verify",{challenge_id:y,code:f});j(a.access_token),sessionStorage.setItem("lotly_admin_access_token",a.access_token),d("success"),e.push("/")}catch(e){N(e instanceof Error?e.message:"MFA verification failed.")}finally{v(!1)}};return(0,a.jsx)("div",{className:i.default.page,children:(0,a.jsxs)("main",{className:i.default.card,children:[(0,a.jsxs)("header",{className:i.default.header,children:[(0,a.jsx)("p",{className:i.default.kicker,children:"Lotly Admin"}),(0,a.jsx)("h1",{children:"Secure admin access"}),(0,a.jsx)("p",{className:i.default.subtitle,children:"Sign in to manage tenants, platform operations, and compliance across the Lotly network."})]}),(0,a.jsxs)("div",{className:i.default.metaRow,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:i.default.metaLabel,children:"API"}),(0,a.jsx)("p",{className:i.default.metaValue,children:n.apiBaseUrl})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:i.default.metaLabel,children:"Security"}),(0,a.jsx)("p",{className:i.default.metaValue,children:"MFA-ready sessions"})]})]}),"login"===o&&(0,a.jsxs)("form",{className:i.default.form,onSubmit:q,children:[(0,a.jsxs)("label",{className:i.default.label,children:["Email",(0,a.jsx)("input",{className:i.default.input,type:"email",name:"email",placeholder:"admin@lotly.com",value:r,onChange:e=>c(e.target.value),required:!0})]}),(0,a.jsxs)("label",{className:i.default.label,children:["Password",(0,a.jsx)("input",{className:i.default.input,type:"password",name:"password",placeholder:"••••••••",value:u,onChange:e=>m(e.target.value),required:!0})]}),(0,a.jsxs)("label",{className:i.default.label,children:["Device name",(0,a.jsx)("input",{className:i.default.input,type:"text",name:"device",placeholder:"Admin workstation",value:p,onChange:e=>_(e.target.value)})]}),b&&(0,a.jsx)("p",{className:i.default.error,children:b}),(0,a.jsx)("button",{className:i.default.primaryButton,type:"submit",disabled:k,children:k?"Signing in...":"Sign in"})]}),"mfa"===o&&(0,a.jsxs)("form",{className:i.default.form,onSubmit:w,children:[(0,a.jsxs)("p",{className:i.default.mfaHint,children:["Enter the 6-digit code for ",S||"your account","."]}),(0,a.jsxs)("label",{className:i.default.label,children:["MFA code",(0,a.jsx)("input",{className:i.default.input,type:"text",name:"mfa",inputMode:"numeric",autoComplete:"one-time-code",placeholder:"123456",value:f,onChange:e=>h(e.target.value),required:!0})]}),b&&(0,a.jsx)("p",{className:i.default.error,children:b}),(0,a.jsx)("button",{className:i.default.primaryButton,type:"submit",disabled:k,children:k?"Verifying...":"Verify"}),(0,a.jsx)("button",{className:i.default.secondaryButton,type:"button",onClick:()=>{d("login"),h(""),N(null)},children:"Back to login"})]}),"success"===o&&(0,a.jsxs)("div",{className:i.default.success,children:[(0,a.jsx)("h2",{children:"Login confirmed"}),(0,a.jsx)("p",{children:"Access token issued for admin API calls."}),(0,a.jsx)("div",{className:i.default.token,children:x||"Token unavailable"}),(0,a.jsx)(l.default,{className:i.default.primaryButton,href:"/",children:"Go to dashboard"})]})]})})}e.s(["default",()=>o])}]);